local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local LP = Players.LocalPlayer
local KIBA_MODE = false
local lastHitTarget = nil
local toggleKey = Enum.KeyCode.R
local dashKey = Enum.KeyCode.Q

-- GUI kecil
local gui = Instance.new("ScreenGui", LP:WaitForChild("PlayerGui"))
gui.ResetOnSpawn = false
local box = Instance.new("Frame", gui)
box.Size = UDim2.new(0,10,0,10)
box.Position = UDim2.new(1,-20,1,-40)
box.BackgroundColor3 = Color3.fromRGB(255,0,0)

local function updateGUI()
	box.BackgroundColor3 = KIBA_MODE and Color3.fromRGB(0,255,0) or Color3.fromRGB(255,0,0)
end

UIS.InputBegan:Connect(function(input,gp)
	if gp then return end
	if input.KeyCode == toggleKey then
		KIBA_MODE = not KIBA_MODE
		updateGUI()
	elseif input.KeyCode == dashKey and KIBA_MODE then
		if lastHitTarget and lastHitTarget:FindFirstChild("HumanoidRootPart") then
			local myChar = LP.Character
			if myChar and myChar:FindFirstChild("HumanoidRootPart") then
				local myHRP = myChar.HumanoidRootPart
				local tgtHRP = lastHitTarget.HumanoidRootPart

				-- lock orientasi tubuh selama 0.35 detik
				local start = tick()
				while tick() - start < 0.35 do
					if not myChar or not myChar:FindFirstChild("HumanoidRootPart") then break end
					if not tgtHRP or not tgtHRP.Parent then break end
					myChar:PivotTo(CFrame.new(myHRP.Position, tgtHRP.Position))
					RunService.RenderStepped:Wait()
				end
			end
		end
	end
end)

-- update last target kalau kena hit (harus disesuaikan dengan event hit game kamu)
-- contoh sederhana: klik kiri pada player lain
UIS.InputBegan:Connect(function(input,gp)
	if gp then return end
	if input.UserInputType == Enum.UserInputType.MouseButton1 then
		local m = LP:GetMouse()
		if m.Target and m.Target.Parent and Players:FindFirstChild(m.Target.Parent.Name) then
			lastHitTarget = m.Target.Parent
		end
	end
end)

updateGUI()
